apiVersion: apps/v1
kind: Deployment
metadata:
  name: rust-hoverfly
spec:
  replicas: 3
  selector:
    matchLabels:
      name: rust-hoverfly
  template:
    metadata:
      labels:
        name: rust-hoverfly
    spec:
      containers:
        - name: rust-hoverfly
          image: spectolabs/hoverfly:v1.6.3
          args:
            - -webserver
            - -log-level
            - warn
            - -import
            - /simulations/jwks.json
            - -import
            - /simulations/steps.json
            - -response-body-files-path
            - /responses
          volumeMounts:
            - name: rust-hoverfly-simulations-volume
              mountPath: /simulations
              readOnly: true
            - name: rust-hoverfly-responses-volume
              mountPath: /responses
              readOnly: true
      volumes:
        - name: rust-hoverfly-simulations-volume
          configMap:
            name: rust-hoverfly-simulations
        - name: rust-hoverfly-responses-volume
          configMap:
            name: rust-hoverfly-responses
